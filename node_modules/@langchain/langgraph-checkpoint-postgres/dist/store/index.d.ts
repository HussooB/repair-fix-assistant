import { DistanceMetric, Embeddings, EmbeddingsFunc, FilterOperators, HNSWConfig, IVFFlatConfig, IndexConfig, PostgresStoreConfig, PutOptions, SearchItem, SearchOptions, TTLConfig, VectorIndexType } from "./modules/types.js";
import { BaseStore, Item, Operation, OperationResults } from "@langchain/langgraph-checkpoint";

//#region src/store/index.d.ts

/**
 * PostgreSQL implementation of the BaseStore interface.
 * This is now a lightweight orchestrator that delegates to specialized modules.
 */
declare class PostgresStore extends BaseStore {
  private core;
  private vectorOps;
  private crudOps;
  private searchOps;
  private ttlManager;
  private isSetup;
  private isClosed;
  private ensureTables;
  constructor(config: PostgresStoreConfig);
  /**
   * Put an item with optional indexing configuration and TTL.
   */
  put(namespace: string[], key: string, value: Record<string, unknown>, index?: false | string[], options?: {
    ttl?: number;
  }): Promise<void>;
  /**
   * Get an item by namespace and key.
   */
  get(namespace: string[], key: string): Promise<Item | null>;
  /**
   * Delete an item by namespace and key.
   */
  delete(namespace: string[], key: string): Promise<void>;
  /**
   * List namespaces with optional filtering.
   */
  listNamespaces(options?: {
    prefix?: string[];
    suffix?: string[];
    maxDepth?: number;
    limit?: number;
    offset?: number;
  }): Promise<string[][]>;
  /**
   * Creates a PostgresStore instance from a connection string.
   */
  static fromConnString(connectionString: string, options?: Omit<PostgresStoreConfig, "connectionOptions">): PostgresStore;
  /**
   * Initialize the store by running migrations to create necessary tables and indexes.
   */
  setup(): Promise<void>;
  private runStoreMigrations;
  /**
   * Execute multiple operations in a single batch.
   */
  batch<Op extends Operation[]>(operations: Op): Promise<OperationResults<Op>>;
  private executeListNamespaces;
  /**
   * Start the store. Calls setup() if ensureTables is true.
   */
  start(): Promise<void>;
  /**
   * Stop the store and close all database connections.
   */
  stop(): Promise<void>;
  /**
   * Manually sweep expired items from the store.
   */
  sweepExpiredItems(): Promise<number>;
  private textSearch;
  /**
   * Get statistics about the store.
   */
  getStats(): Promise<{
    totalItems: number;
    expiredItems: number;
    namespaceCount: number;
    oldestItem: Date | null;
    newestItem: Date | null;
  }>;
  /**
   * Performs vector similarity search using embeddings.
   *
   * @param namespacePrefix - The namespace prefix to search within
   * @param query - The text query to embed and search for similar items
   * @param options - Search options including filter, similarity threshold, and distance metric
   * @returns Promise resolving to an array of search results with similarity scores
   */
  protected vectorSearch(namespacePrefix: string[], query: string, options?: {
    filter?: Record<string, unknown>;
    limit?: number;
    offset?: number;
    similarityThreshold?: number;
    distanceMetric?: "cosine" | "l2" | "inner_product";
  }): Promise<SearchItem[]>;
  /**
   * Performs hybrid search combining vector similarity and text search.
   *
   * @param namespacePrefix - The namespace prefix to search within
   * @param query - The text query to search for
   * @param options - Search options including filter, vector weight, and similarity threshold
   * @returns Promise resolving to an array of search results with combined similarity scores
   */
  protected hybridSearch(namespacePrefix: string[], query: string, options?: {
    filter?: Record<string, unknown>;
    limit?: number;
    offset?: number;
    vectorWeight?: number;
    similarityThreshold?: number;
  }): Promise<SearchItem[]>;
  /**
   * Search for items in the store with support for text search, vector search, and filtering.
   *
   * @param namespacePrefix - The namespace prefix to search within
   * @param options - Search options including search mode, filters, query text, and pagination
   * @returns Promise resolving to an array of search results with optional similarity scores
   *
   * @example
   * ```typescript
   * // Basic text search
   * const results = await store.search(["documents"], {
   *   query: "machine learning",
   *   mode: "text"
   * });
   *
   * // Vector search
   * const results = await store.search(["documents"], {
   *   query: "machine learning",
   *   mode: "vector",
   *   similarityThreshold: 0.7
   * });
   *
   * // Hybrid search (combining vector and text)
   * const results = await store.search(["documents"], {
   *   query: "machine learning",
   *   mode: "hybrid",
   *   vectorWeight: 0.7
   * });
   *
   * // Filtered search
   * const results = await store.search(["products"], {
   *   filter: { category: "electronics", price: { $lt: 100 } }
   * });
   * ```
   */
  search(namespacePrefix: string[], options?: {
    /**
     * Filter conditions with support for advanced operators.
     */
    filter?: Record<string, string | number | boolean | null | FilterOperators>;
    /**
     * Natural language search query.
     */
    query?: string;
    /**
     * Maximum number of results to return.
     * @default 10
     */
    limit?: number;
    /**
     * Number of results to skip for pagination.
     * @default 0
     */
    offset?: number;
    /**
     * Whether to refresh TTL for returned items.
     */
    refreshTtl?: boolean;
    /**
     * Search mode.
     * @default "auto"
     */
    mode?: "text" | "vector" | "hybrid" | "auto";
    /**
     * Similarity threshold for vector search.
     */
    similarityThreshold?: number;
    /**
     * Distance metric for vector search.
     * @default "cosine"
     */
    distanceMetric?: "cosine" | "l2" | "inner_product";
    /**
     * Weight for vector search in hybrid mode.
     * @default 0.7
     */
    vectorWeight?: number;
  }): Promise<SearchItem[]>;
}
//#endregion
export { DistanceMetric, Embeddings, EmbeddingsFunc, FilterOperators, HNSWConfig, IVFFlatConfig, IndexConfig, PostgresStore, PostgresStoreConfig, PutOptions, SearchItem, SearchOptions, TTLConfig, VectorIndexType };
//# sourceMappingURL=index.d.ts.map